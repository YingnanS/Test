% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CV_statistics.R
\name{run_edec_stage2_for_genes}
\alias{run_edec_stage2_for_genes}
\title{Run EDec Stage 2 for each gene}
\usage{
run_edec_stage2_for_genes(
  expression_matrix,
  cell_type_proportions,
  min_samples = 30,
  method
)
}
\arguments{
\item{expression_matrix}{Matrix or data frame of gene expression (rows = genes, columns = samples)}

\item{cell_type_proportions}{Matrix of cell type proportions (rows = samples, columns = cell types)}

\item{min_samples}{Minimum number of non-NA samples required to perform deconvolution for a gene}

\item{method}{A function that performs stage 2 deconvolution (must accept gene_exp_bulk_samples and cell_type_props)}
}
\value{
A list containing:
\describe{
\item{means}{Matrix of estimated means for each gene and cell type}
\item{std_errors}{Matrix of standard errors}
\item{residuals}{Matrix of residuals for each gene}
\item{explained_variances}{Named numeric vector of R-squared per gene}
\item{degrees_of_freedom}{Named numeric vector of degrees of freedom per gene}
}
}
\description{
This function iteratively performs deconvolution on each gene across samples using
a specified stage 2 deconvolution method (e.g., \code{EDec::run_edec_stage_2}).
}
